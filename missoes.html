@ -0,0 +1,161 @@
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resumo de Missões - Agência MIST</title>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="auth-check.js"></script>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        /* CSS Final para a coluna Ações */
        thead th:last-child,
        tbody td:last-child {
            width: 50px;
            text-align: center;
        }
        .actions-cell {
            padding: 5px 0;
        }
        .actions-cell button {
            display: block;
            margin: 0 auto;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }
        .actions-cell button:first-child {
            margin-bottom: 5px;
        }
        .edit-btn { background-color: #f39c12; }
        .edit-btn:hover { background-color: #e67e22; }
        .delete-btn { background-color: #e74c3c; }
        .delete-btn:hover { background-color: #c0392b; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Resumo de Missões</h1>
            <nav>
                <a href="index.html" style="margin-right: 20px;">Página Inicial</a>
                <a href="#" onclick="logout()">Sair</a>
            </nav>
        </header>
        
        <table>
            <thead>
                <tr>
                    <th>Missão</th>
                    <th>Data</th>
                    <th>Recompensa</th>
                    <th>Agência</th>
                    <th>Akane</th>
                    <th>Gemini</th>
                    <th>Tilas</th>
                    <th>Daemian</th>
                    <th>Bart</th>
                    <th>Resumo</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody id="missions-table-body"></tbody>
        </table>

        <div class="form-container">
            <h3 id="form-title">Adicionar Nova Missão</h3>
            <form id="mission-form">
                <input type="hidden" id="mission-id">
                <div class="form-group"><label for="mission-name">Nome da Missão</label><input type="text" id="mission-name" required></div>
                <div class="form-group"><label for="mission-date">Data</label><input type="text" id="mission-date" placeholder="dd/mm/aaaa"></div>
                <div class="form-group"><label for="mission-reward">Recompensa Total</label><input type="number" id="mission-reward" value="0"></div>
                <div class="form-group"><label for="mission-agency">Agência</label><input type="number" id="mission-agency" value="0"></div>
                <div class="form-group"><label for="mission-akane">Akane</label><input type="number" id="mission-akane" value="0"></div>
                <div class="form-group"><label for="mission-gemini">Gemini</label><input type="number" id="mission-gemini" value="0"></div>
                <div class="form-group"><label for="mission-tilas">Tilas</label><input type="number" id="mission-tilas" value="0"></div>
                <div class="form-group"><label for="mission-daemian">Daemian</label><input type="number" id="mission-daemian" value="0"></div>
                <div class="form-group"><label for="mission-bart">Bart</label><input type="number" id="mission-bart" value="0"></div>
                <div class="form-group"><label for="mission-summary">Resumo</label><textarea id="mission-summary" rows="3"></textarea></div>
                <button type="submit" id="submit-btn">Adicionar Missão</button>
                <button type="button" id="cancel-btn" style="display:none;">Cancelar Edição</button>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        const db = firebase.firestore();
        const missionsCollection = db.collection("missions");

        const form = document.getElementById('mission-form');
        const tableBody = document.getElementById('missions-table-body');
        const formTitle = document.getElementById('form-title');
        const submitBtn = document.getElementById('submit-btn');
        const cancelBtn = document.getElementById('cancel-btn');

        const resetForm = () => { form.reset(); form['mission-id'].value = ''; formTitle.textContent = 'Adicionar Nova Missão'; submitBtn.textContent = 'Adicionar Missão'; cancelBtn.style.display = 'none'; };
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const missionId = form['mission-id'].value;
            const missionData = {
                name: form['mission-name'].value, date: form['mission-date'].value,
                reward: Number(form['mission-reward'].value), agency: Number(form['mission-agency'].value),
                akane: Number(form['mission-akane'].value), gemini: Number(form['mission-gemini'].value),
                tilas: Number(form['mission-tilas'].value), daemian: Number(form['mission-daemian'].value),
                bart: Number(form['mission-bart'].value), summary: form['mission-summary'].value
            };
            if (missionId) { await missionsCollection.doc(missionId).update(missionData); } 
            else { await missionsCollection.add({ ...missionData, createdAt: firebase.firestore.FieldValue.serverTimestamp() }); }
            resetForm();
        });
        
        const deleteMission = async (id) => { if (confirm("Tem certeza que deseja excluir esta missão?")) { await missionsCollection.doc(id).delete(); } };
        
        const editMission = (id, data) => {
            form['mission-id'].value = id; form['mission-name'].value = data.name;
            form['mission-date'].value = data.date; form['mission-reward'].value = data.reward;
            form['mission-agency'].value = data.agency; form['mission-akane'].value = data.akane;
            form['mission-gemini'].value = data.gemini; form['mission-tilas'].value = data.tilas;
            form['mission-daemian'].value = data.daemian; form['mission-bart'].value = data.bart;
            form['mission-summary'].value = data.summary;
            formTitle.textContent = 'Editando Missão';
            submitBtn.textContent = 'Salvar Alterações';
            cancelBtn.style.display = 'inline-block';
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        };
        
        cancelBtn.addEventListener('click', resetForm);

        missionsCollection.orderBy("createdAt", "desc").onSnapshot(snapshot => {
            tableBody.innerHTML = '';
            snapshot.docs.forEach(doc => {
                const mission = doc.data();
                const missionId = doc.id;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${mission.name}</td><td>${mission.date}</td><td>${mission.reward}</td>
                    <td>${mission.agency}</td><td>${mission.akane}</td><td>${mission.gemini}</td>
                    <td>${mission.tilas}</td><td>${mission.daemian}</td><td>${mission.bart}</td>
                    <td>${mission.summary}</td>
                    <td class="actions-cell">
                        <button class="edit-btn" title="Editar"><i class="fas fa-pencil-alt"></i></button>
                        <br>
                        <button class="delete-btn" title="Excluir"><i class="fas fa-times"></i></button>
                    </td>`;
                row.querySelector('.edit-btn').addEventListener('click', () => editMission(missionId, mission));
                row.querySelector('.delete-btn').addEventListener('click', () => deleteMission(missionId));
                tableBody.appendChild(row);
            });
        });
    </script>
</body>
</html>